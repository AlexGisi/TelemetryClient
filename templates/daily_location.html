<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>KU Solar Car Telemetry</title>
		<link rel="stylesheet" type="text/css" href="../static/css/style.css">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<script src="../static/javascript/lib/Moment.js"></script>
		<script src="../static/javascript/Chart.js"></script>
		<style type="text/css">
			html, body { height: 100%; }
			body {
				display: flex;
				flex-flow: column;
				margin: 0;
			}
			#date-changer, #time-changer {
				margin: 8px 0 8px 0;
			}
			#date-changer input, #date-changer button {
				font-size: 16pt;
			}
			#date-changer form {
				display: inline-block;
				margin: 0;
			}
			#tabs {
				z-index: 100;
			}
			#tabs form {
				display: inline-block;
			}

			.tab {
				display: inline-block;
				background: #ddd;
				border: 1px solid black;
				border-radius: 4px 4px 0 0;
				padding: 4px;
				font-family: sans-serif;
				font-size: 16pt;
				min-width: 5em;
				margin-bottom: -1.5px; /* Makes bottom of tab overlap with graph container */
				cursor: pointer;
			}
			.tab.active {
				background: white;
				font-weight: bold;
				border-bottom-color: white;
				border-width: 2px;
				padding: 3px;
			}
			#graph-container {
				flex: 1;
				padding: 0 8px 8px 8px;
			}
			.graph {
				width: 100%;
				height: 100%;
				background: white;
				border: 1px solid black;
				border-radius: 4px;
			}
            #map {
                width: 99%;
                margin: auto;
                height: 95%;
            }
            #no-info {
                max-width: 400px;
                margin: 50px auto;
                padding: 15px;
                display: none;
                border-style: solid;
                border-width: thin;
                border-radius: 5px;
            }
		</style>
		<script type="text/javascript">
			// Seeded random color for string - in the future there should be colors in client_format.json
			// https://gist.github.com/0x263b/2bdd90886c2036a1ad5bcf06d6e6fb37
			String.prototype.toHue = function() {
				var hash = 0;
				if (this.length === 0) return hash;
				for (var i = 0; i < this.length; i++) {
					hash = this.charCodeAt(i) + ((hash << 5) - hash);
					hash = hash & hash;
				}
				return hash % 360;
			};

			// pass list of location pairs for use in js map drawing
            let location_pairs = {{ location_pairs|tojson }};

            // pass starttime and endtime, needed to set dropdowns on page reload
            let starttime = {{ starttime }};
            let endtime = {{ endtime }};
		</script>
	</head>
	<body>
		<div id="bg"></div>
        <div id="date-changer">
            <form>
                <input type="hidden" name="tab" value="{{tab}}">
                <button type="submit" name="date" value="{{prev_date_str}}">&#9668;</button>
            </form>
            <form>
                <input type="hidden" name="tab" value="{{tab}}">
                <input type="date" name="date" value="{{date_str}}" oninput="this.form.submit()">
            </form>
            <form>
                <input type="hidden" name="tab" value="{{tab}}">
                <button type="submit" name="date" value="{{next_date_str}}">&#9658;</button>
            </form>
        </div>

		<div id="tabs">
			{% for tab_link in tab_list %}
				<form>
					<input type="hidden" name="date" value="{{date_str}}">
					<button type="submit" name="tab" class="tab{% if tab_link == tab %} active{% endif %}" value="{{tab_link}}">{{tab_link}}</button>
				</form>
			{% endfor %}
		</div>

        <div style="height: 8px"></div>
        <div id="times">
            <form id="time-form">
                <input type="hidden" name="date" value="{{date_str}}">
                <input type="hidden" name="tab" value="{{tab}}">
                <label for="start-time">From: </label>
                <select id="start-time" name="starttime" onchange="on_select_change()">
                    <option value="0" selected>12 AM</option>
                    <option value="3600">1 AM</option>
                    <option value="7200">2 AM</option>
                    <option value="10800">3 AM</option>
                    <option value="14400">4 AM</option>
                    <option value="18000">5 AM</option>
                    <option value="21600">6 AM</option>
                    <option value="25200">7 AM</option>
                    <option value="28800">8 AM</option>
                    <option value="32400">9 AM</option>
                    <option value="36000">10 AM</option>
                    <option value="39600">11 AM</option>
                    <option value="43200">12 PM</option>
                    <option value="46800">1 PM</option>
                    <option value="50400">2 PM</option>
                    <option value="54000">3 PM</option>
                    <option value="57600">4 PM</option>
                    <option value="61200">5 PM</option>
                    <option value="64800">6 PM</option>
                    <option value="68400">7 PM</option>
                    <option value="72000">8 PM</option>
                    <option value="75600">9 PM</option>
                    <option value="79200">10 PM</option>
                    <option value="82800">11 PM</option>
                </select>
                <label for="end-time">To: </label>
                <select id="end-time" name="endtime" onchange="on_select_change()">
                    <option value="3600">1 AM</option>
                    <option value="7200">2 AM</option>
                    <option value="10800">3 AM</option>
                    <option value="14400">4 AM</option>
                    <option value="18000">5 AM</option>
                    <option value="21600">6 AM</option>
                    <option value="25200">7 AM</option>
                    <option value="28800">8 AM</option>
                    <option value="32400">9 AM</option>
                    <option value="36000">10 AM</option>
                    <option value="39600">11 AM</option>
                    <option value="43200">12 PM</option>
                    <option value="46800">1 PM</option>
                    <option value="50400">2 PM</option>
                    <option value="54000">3 PM</option>
                    <option value="57600">4 PM</option>
                    <option value="61200">5 PM</option>
                    <option value="64800">6 PM</option>
                    <option value="68400">7 PM</option>
                    <option value="72000">8 PM</option>
                    <option value="75600">9 PM</option>
                    <option value="79200">10 PM</option>
                    <option value="82800">11 PM</option>
                    <option value="86400">11:59 PM</option>
                </select>
            </form>
        </div>

        <!--The div element for the map -->
        <div id="map"></div>

        <!-- Hidden by default -->
        <div id="no-info">
            <h3>No Activity For Selected Period</h3>
        </div>

        <!-- Map script-->
        <script src="../static/javascript/map.js"></script>

        <!-- Initialize map -->
        <script src="{{ maps_url }}"></script>
	</body>
</html>
